Version: 1.0

RestoreWorkspace: Default
SaveWorkspace: Default
AlwaysSaveHistory: Default

EnableCodeIndexing: Yes
UseSpacesForTab: Yes
NumSpacesForTab: 2
Encoding: UTF-8

RnwWeave: Sweave
LaTeX: pdfLaTeX

# Assignment 4
# R Coding
# Caroline Rodrigues

# Save ufo data file to your working directory
# Visually inspect and compare your data frame to the original csv 
ufo.data <- read.csv("ufo_subset.csv")
View(ufo.data)

# Find rows where shape information is missing and enter "unknown"
missing_shape <- which(ufo.data$shape =="")
ufo.data$shape[missing_shape] <- "unknown"
# Check to see if this worked
View(ufo.data)
# This worked! 


# Remove the rows that do not have Country information
ufo.data1 <- ufo.data[!ufo.data$country == "", ]
View(ufo.data1)


# Convert Datetime and Date_posted columns into appropriate formats
# I have chosen to keep formats consistent to Y-m-d
ufo.data2 <- ufo.data1
ufo.data2$date_posted <- as.Date(ufo.data1$date_posted, format = "%d-%m-%Y")
View(ufo.data2)


# Identify possible hoax reports
ufo.data3 <- ufo.data2
# Create a new boolean column "is_hoax"
# Populate this column with TRUE if the sighting is a possible hoax, FALSE otherwise
ufo.data3$is_Hoax <- grepl("\\bhoax\\b", ufo.data2$comment, ignore.case = TRUE)
View(ufo.data3)


# To create a table finding hoax per country
# First, find total number of hoax. This will act as our denominator
hoax_total <- sum(ufo.data3$is_Hoax == TRUE)
# Then, find the subset of each country where hoax = True
au_hoax <- (sum(ufo.data3$country == trimws("au") & ufo.data3$is_Hoax == TRUE))/ hoax_total * 100 # Divide each by the total number of hoax
us_hoax <- (sum(ufo.data3$country == trimws("us") & ufo.data3$is_Hoax == TRUE))/ hoax_total * 100
ca_hoax <- (sum(ufo.data3$country == trimws("ca") & ufo.data3$is_Hoax == TRUE))/ hoax_total * 100
de_hoax <- (sum(ufo.data3$country == trimws("de") & ufo.data3$is_Hoax == TRUE))/ hoax_total * 100
gb_hoax <- (sum(ufo.data3$country == trimws("gb") & ufo.data3$is_Hoax == TRUE))/ hoax_total * 100

# Table reporting hoax per country
hoax_per_country <- data.frame(au_hoax, us_hoax, ca_hoax, de_hoax, gb_hoax)
View(hoax_per_country)

